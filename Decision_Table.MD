# Decision matrix

| GitOps                       |                                                               |                                                    |                                                                                      |                                                     |                                        | Notes                                                                            |
| ---------------------------- | ------------------------------------------------------------- | -------------------------------------------------- | ------------------------------------------------------------------------------------ | --------------------------------------------------- | -------------------------------------- | -------------------------------------------------------------------------------- |
| ArgoCD                       |                                                               | FluxCD                                             | âœ…                                                                                    | AKS GitOps                                          |                                        | Operating processes                                                              |
| Pros                         | Cons                                                          | Pros                                               | Cons                                                                                 | Pros                                                | Cons                                   | Dual use                                                                         |
| Best UI                      | UBS have stated a preference for flux                         | Easier to bootstrap                                | No GUI                                                                               | Simple GUI                                          | Preview                                | FlUX cd                                                                          |
| Easier to visualise issues   | Harder to manage Argo with GitOps                             | Can self manage with Flux                          | Requires a fundamental understanding of what is deploying and how                    | Integrated as a service                             | Az Cli integration seems temperamental |                                                                                  |
| Plugins system               | Kustomize requires a plugin build                             | Multi-tenancy support                              |                                                                                      |                                                     | Must use Kustomize deployment method   |                                                                                  |
| SSO                          | Logging is more obfuscated                                    | App-of-apps pattern works better                   |                                                                                      |                                                     |                                        |                                                                                  |
|                              |                                                               |                                                    |                                                                                      |                                                     |                                        |                                                                                  |
| Build                        |                                                               |                                                    |                                                                                      |                                                     |                                        |                                                                                  |
| Kaniko (or other build tool) |                                                               | Buildpacks                                         |                                                                                      |                                                     |                                        |                                                                                  |
| Pros                         | Cons                                                          | Pros                                               | Cons                                                                                 |                                                     |                                        |                                                                                  |
| Uses Dockerfiles             | Difficult to update compromised base layers                   | Depends on support model                           | Less mature project                                                                  |                                                     |                                        | Operational change to shift right comes with using buildpacks                    |
| Familiar                     |                                                               |                                                    | Less community support available                                                     |                                                     |                                        | Also considered Builder and/or Podman                                            |
| industry standard            |                                                               |                                                    | Immature adoption                                                                    |                                                     |                                        | To Dockerfile or not to Dockerfile                                               |
|                              |                                                               |                                                    |                                                                                      |                                                     |                                        |                                                                                  |
| Secret store                 |                                                               |                                                    |                                                                                      |                                                     |                                        |                                                                                  |
| AKV                          |                                                               | Hashicorp Vault                                    |                                                                                      |                                                     |                                        | Notes                                                                            |
| Pros                         | Cons                                                          | Pros                                               | Cons                                                                                 |                                                     |                                        |                                                                                  |
| Cloud native                 | Not UBS Standard                                              | UBS standard                                       | Third party                                                                          |                                                     |                                        | Flexibility                                                                      |
|                              |                                                               | Agent mode integration                             |                                                                                      |                                                     |                                        |                                                                                  |
|                              |                                                               |                                                    |                                                                                      |                                                     |                                        |                                                                                  |
| Registry Store               |                                                               |                                                    |                                                                                      |                                                     |                                        |                                                                                  |
| ACR                          |                                                               | Nexus                                              |                                                                                      |                                                     |                                        | Notes                                                                            |
| Pros                         | Cons                                                          | Pros                                               | Cons                                                                                 |                                                     |                                        |                                                                                  |
| Cloud native                 | Not UBS standard                                              | UBS standard                                       | Not isn't cloud native                                                               |                                                     |                                        | What are the standards around availability of Nexus, uptime etc                  |
| Shift left support           | Security tooling not integrated (currently)                   | Feature rich                                       | Intgration process may add complexity                                                |                                                     |                                        |                                                                                  |
|                              | Fewer features than Nexus                                     |                                                    | No continual scanning once image is deployed                                         |                                                     |                                        |                                                                                  |
|                              |                                                               |                                                    |                                                                                      |                                                     |                                        |                                                                                  |
| Logging                      |                                                               |                                                    |                                                                                      |                                                     |                                        |                                                                                  |
| Azure log analytics          |                                                               | Weavescope                                         |                                                                                      | Loki                                                |                                        |                                                                                  |
| Pros                         | Cons                                                          | Pros                                               | Cons                                                                                 | Pros                                                | Cons                                   | This needs to outline what also needs to be used for operational troubleshooting |
| Definitely will be used      |                                                               | Real time contextual metrics                       | scope reports aren't persistent, probe stores metrics in memory                      | Cloud Native, HA, supports object storage           |                                        | Grafana                                                                          |
|                              |                                                               | Manage/troubleshoot containers easily from the UI  |                                                                                      | Tiny indexes rather than indexing full logs - LogQL | queries might be less performant       | Loki - Promtail                                                                  |
|                              |                                                               | Simple search feature                              | Doesn't support complex QL for log aggregation                                       | Multi-tenancy support                               |                                        |                                                                                  |
|                              |                                                               |                                                    |                                                                                      |                                                     |                                        |                                                                                  |
|                              |                                                               |                                                    |                                                                                      |                                                     |                                        |                                                                                  |
|                              |                                                               |                                                    |                                                                                      |                                                     |                                        |                                                                                  |
| Node Patching                |                                                               |                                                    |                                                                                      |                                                     |                                        |                                                                                  |
| kured                        |                                                               | Nodepool Images                                    |                                                                                      |                                                     |                                        |                                                                                  |
| Pros                         | Cons                                                          | Pros                                               | Cons                                                                                 |                                                     |                                        |                                                                                  |
| Kubernetes Native            | Patches will be untested by nature                            | Can be facilitated by an external service          | Image definition provided by MS                                                      |                                                     |                                        |                                                                                  |
| Bleeding edge updates        | Automated nature means having faith the process works end:end | Node image should be tested and more like "Cattle" | Historically Microsoft have released bad images that has caused issues with clusters |                                                     |                                        |                                                                                  |
| Control over patching        | Process is closer to treating the node as a "Pet"             |                                                    |                                                                                      |                                                     |                                        |                                                                                  |
| Notification support         |                                                               |                                                    |                                                                                      |                                                     |                                        |                                                                                  |
| Fully automated              |                                                               |                                                    |                                                                                      |                                                     |                                        |